# Quick Fix Guide - Nov 11, 2025

## Issues Fixed

### 1. Media Gallery 404 Error ✅
**Problem**: Gallery shows "Media not found" (404 error)  
**Root Cause**: FastAPI route ordering issue - `/list` was being matched as `/{media_id}`  
**Fix**: Moved specific routes (`/list`, `/stats`) before parameterized route in `backend/routers/media.py`

### 2. Image Generation Error ✅  
**Problem**: `imagen-3.0-generate-002 is not found for API version v1beta`  
**Root Cause**: Imagen 3.0 model not available in current API  
**Fix**: Removed Imagen 3.0 from default model registry, set Nano Banana as default

## Files Changed

- `backend/routers/media.py` - Fixed route ordering
- `backend/utils/config.py` - Removed Imagen 3.0, made Nano Banana default
- `Changelog.md` - Documented changes in v2.0.4
- `docs/ARCHITECTURE.md` - Updated model documentation

## How to Apply Fixes

You need to restart your backend service to apply these changes:

### Option 1: If using development mode (start-dev.sh)
```bash
# Find and kill the backend process
ps aux | grep uvicorn
kill <PID>

# Restart
./start-dev.sh
```

### Option 2: If using Docker
```bash
# Restart just the backend
docker-compose restart backend

# Or rebuild everything
docker-compose down
docker-compose up --build
```

### Option 3: Manual restart
```bash
cd backend
# Activate your venv if you have one
source venv/bin/activate  # or . venv/Scripts/activate on Windows

# Restart uvicorn
uvicorn main:app --reload --port 8000 --root-path /HdMImageVideo
```

## What to Test

After restarting:

1. **Gallery**: Go to `/HdMImageVideo/gallery` - should now load media list
2. **Image Generation**: 
   - Should now default to Nano Banana (Gemini 2.5 Flash)
   - No more Imagen 3.0 option
   - Imagen 4.0 still available (if you have access)

## Models Now Available

### Image Models (in order)
1. ✅ **Nano Banana (Gemini 2.5 Flash)** - DEFAULT, most reliable
2. **Imagen 4.0** - High quality (may require special API access)
3. ~~Imagen 3.0~~ - REMOVED (not available in v1beta API)

### Video Models (unchanged)
1. Veo 3.1
2. Veo 3.1 Fast  
3. Veo 3.0
4. Veo 3.0 Fast
5. Veo 2.0

## Additional Notes

- If Imagen 4.0 doesn't work for you, it likely means your API key doesn't have access
- Nano Banana works with any standard Gemini API key
- If you somehow have access to Imagen 3.0, you can uncomment it in `backend/utils/config.py`

## Need Help?

Check the logs:
```bash
# If using docker
docker-compose logs backend

# If running manually
# Look at the terminal where uvicorn is running
```

---

**Changes documented in**: Changelog.md v2.0.4  
**Date**: November 11, 2025

